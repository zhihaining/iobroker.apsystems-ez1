"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.LegacyTranslator = void 0;
const axios_1 = __importDefault(require("axios"));
const network_1 = require("../network");
/**
 * @see Translator implementation that uses the old Google Translation API.
 * This API is rate limited and the user will see an error if too many
 * translation requests are done within a given timespan.
 */
class LegacyTranslator {
    async translate(text, targetLang) {
        const url = `http://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=${targetLang}&dt=t&q=${encodeURIComponent(text)}&ie=UTF-8&oe=UTF-8`;
        let options = {
            url,
            timeout: (0, network_1.getRequestTimeout)(),
        };
        // If an https-proxy is defined as an env variable, use it
        options = (0, network_1.applyHttpsProxy)(options);
        const response = await (0, axios_1.default)(options);
        if (Array.isArray(response.data)) {
            // we got a valid response
            return response.data[0].map((t) => t[0]).join("");
        }
        throw new Error(`Invalid response for translate request`);
    }
}
exports.LegacyTranslator = LegacyTranslator;
//# sourceMappingURL=legacy-translator.js.map